{% comment %}
Page Header Component - HealthSphere AI
======================================

Usage Examples:
{% include 'components/page_header.html' with title="Patient Dashboard" subtitle="Overview of patient information and health metrics" %}
{% include 'components/page_header.html' with title="Appointments" subtitle="Manage and schedule patient appointments" breadcrumbs=breadcrumbs %}
{% include 'components/page_header.html' with title="Patient Profile" subtitle="John Doe" breadcrumbs=breadcrumbs actions=actions %}
{% include 'components/page_header.html' with title="Analytics" subtitle="Health insights and reporting" variant="centered" size="large" %}

Parameters:
- title: Main page title (required)
- subtitle: Optional subtitle or description
- breadcrumbs: List of breadcrumb items (optional)
- actions: List of action buttons (optional)
- variant: "default", "centered", "minimal" (default: default)
- size: "sm", "md", "lg", "xl" (default: md)
- background: "glass", "solid", "transparent" (default: glass)
- border: Boolean to show bottom border (default: True)
- sticky: Boolean to make header sticky (default: False)
- icon: Optional icon for the title
- meta: Additional metadata (date, status, etc.)

Breadcrumbs structure:
breadcrumbs: [
    {label: "Home", url: "/", icon: "fas fa-home"},
    {label: "Patients", url: "/patients/"},
    {label: "John Doe", active: True}
]

Actions structure:
actions: [
    {text: "Add New", url: "/add/", class: "healthcare-btn-primary", icon: "fas fa-plus"},
    {text: "Export", onclick: "exportData()", class: "healthcare-btn-secondary", icon: "fas fa-download"},
    {text: "Settings", url: "/settings/", class: "healthcare-btn-outline", icon: "fas fa-cog"}
]

Meta structure:
meta: [
    {label: "Last Updated", value: "2 hours ago", icon: "fas fa-clock"},
    {label: "Status", value: "Active", type: "status", variant: "success"}
]

{% endcomment %}

{% load static %}

<!-- Page Header Container -->
<header class="healthcare-page-header healthcare-page-header-{{ variant|default:'default' }} healthcare-page-header-{{ size|default:'md' }} healthcare-page-header-{{ background|default:'glass' }}{% if border %} healthcare-page-header-bordered{% endif %}{% if sticky %} healthcare-page-header-sticky{% endif %}"
        role="banner"
        aria-label="Page header">
    
    <!-- Header Content -->
    <div class="healthcare-page-header-content">
        
        <!-- Breadcrumbs Section -->
        {% if breadcrumbs %}
        <nav class="healthcare-page-header-breadcrumbs" aria-label="Breadcrumb navigation">
            <ol class="healthcare-breadcrumb-list">
                {% for item in breadcrumbs %}
                <li class="healthcare-breadcrumb-item{% if item.active %} healthcare-breadcrumb-active{% endif %}">
                    {% if not item.active and item.url %}
                    <a href="{{ item.url }}" class="healthcare-breadcrumb-link">
                        {% if item.icon %}
                        <i class="{{ item.icon }}" aria-hidden="true"></i>
                        {% endif %}
                        <span>{{ item.label }}</span>
                    </a>
                    {% else %}
                    <span class="healthcare-breadcrumb-text">
                        {% if item.icon %}
                        <i class="{{ item.icon }}" aria-hidden="true"></i>
                        {% endif %}
                        <span>{{ item.label }}</span>
                    </span>
                    {% endif %}
                    
                    {% if not forloop.last %}
                    <i class="healthcare-breadcrumb-separator fas fa-chevron-right" aria-hidden="true"></i>
                    {% endif %}
                </li>
                {% endfor %}
            </ol>
        </nav>
        {% endif %}
        
        <!-- Main Header Section -->
        <div class="healthcare-page-header-main">
            
            <!-- Title Section -->
            <div class="healthcare-page-header-title-section">
                <div class="healthcare-page-header-title-wrapper">
                    {% if icon %}
                    <div class="healthcare-page-header-icon">
                        <i class="{{ icon }}" aria-hidden="true"></i>
                    </div>
                    {% endif %}
                    
                    <div class="healthcare-page-header-titles">
                        <h1 class="healthcare-page-header-title">{{ title }}</h1>
                        {% if subtitle %}
                        <p class="healthcare-page-header-subtitle">{{ subtitle }}</p>
                        {% endif %}
                    </div>
                </div>
                
                <!-- Meta Information -->
                {% if meta %}
                <div class="healthcare-page-header-meta">
                    {% for item in meta %}
                    <div class="healthcare-page-header-meta-item{% if item.type %} healthcare-page-header-meta-{{ item.type }}{% endif %}">
                        {% if item.icon %}
                        <i class="{{ item.icon }}" aria-hidden="true"></i>
                        {% endif %}
                        
                        {% if item.label %}
                        <span class="healthcare-page-header-meta-label">{{ item.label }}:</span>
                        {% endif %}
                        
                        <span class="healthcare-page-header-meta-value{% if item.type == 'status' %} healthcare-status-{{ item.variant|default:'default' }}{% endif %}">
                            {{ item.value }}
                        </span>
                    </div>
                    {% endfor %}
                </div>
                {% endif %}
            </div>
            
            <!-- Actions Section -->
            {% if actions %}
            <div class="healthcare-page-header-actions">
                {% for action in actions %}
                {% if action.dropdown %}
                <div class="healthcare-dropdown">
                    <button class="healthcare-btn {{ action.class|default:'healthcare-btn-secondary' }} healthcare-dropdown-toggle"
                            type="button"
                            data-dropdown-toggle
                            aria-haspopup="true"
                            aria-expanded="false">
                        {% if action.icon %}
                        <i class="{{ action.icon }}" aria-hidden="true"></i>
                        {% endif %}
                        <span>{{ action.text }}</span>
                        <i class="fas fa-chevron-down healthcare-dropdown-arrow" aria-hidden="true"></i>
                    </button>
                    
                    <div class="healthcare-dropdown-menu" role="menu">
                        {% for dropdown_item in action.dropdown %}
                        {% if dropdown_item.separator %}
                        <div class="healthcare-dropdown-separator" role="separator"></div>
                        {% else %}
                        <a href="{{ dropdown_item.url|default:'#' }}" 
                           class="healthcare-dropdown-item"
                           role="menuitem"
                           {% if dropdown_item.onclick %}onclick="{{ dropdown_item.onclick }}"{% endif %}>
                            {% if dropdown_item.icon %}
                            <i class="{{ dropdown_item.icon }}" aria-hidden="true"></i>
                            {% endif %}
                            <span>{{ dropdown_item.text }}</span>
                        </a>
                        {% endif %}
                        {% endfor %}
                    </div>
                </div>
                {% else %}
                {% if action.url %}
                <a href="{{ action.url }}" 
                   class="healthcare-btn {{ action.class|default:'healthcare-btn-secondary' }}"
                   {% if action.target %}target="{{ action.target }}"{% endif %}
                   {% if action.disabled %}disabled{% endif %}>
                {% else %}
                <button type="button" 
                        class="healthcare-btn {{ action.class|default:'healthcare-btn-secondary' }}"
                        {% if action.onclick %}onclick="{{ action.onclick }}"{% endif %}
                        {% if action.disabled %}disabled{% endif %}>
                {% endif %}
                    {% if action.icon %}
                    <i class="{{ action.icon }}" aria-hidden="true"></i>
                    {% endif %}
                    <span>{{ action.text }}</span>
                {% if action.url %}
                </a>
                {% else %}
                </button>
                {% endif %}
                {% endif %}
                {% endfor %}
            </div>
            {% endif %}
        </div>
    </div>
    
    <!-- Loading State -->
    <div class="healthcare-page-header-loading" style="display: none;">
        <div class="healthcare-loading-spinner"></div>
    </div>
</header>

<style>
/* =============================================
   Healthcare Page Header Component Styles
   ============================================= */

/* Base Header Styles */
.healthcare-page-header {
    position: relative;
    padding: var(--spacing-6, 24px);
    margin-bottom: var(--spacing-6, 24px);
    border-radius: var(--radius-2xl, 20px);
    font-family: var(--font-sans, 'Inter', system-ui, sans-serif);
    transition: all var(--transition-base, 0.3s ease);
    overflow: hidden;
}

/* Background Variants */
.healthcare-page-header-glass {
    background: var(--glass-bg, rgba(255, 255, 255, 0.95));
    backdrop-filter: var(--glass-blur, blur(20px));
    border: 1px solid var(--glass-border, rgba(255, 255, 255, 0.2));
    box-shadow: var(--glass-shadow-2xl, 0 20px 64px rgba(0, 0, 0, 0.1));
}

.healthcare-page-header-solid {
    background: var(--neutral-white, #ffffff);
    border: 1px solid var(--neutral-200, #e5e7eb);
    box-shadow: var(--shadow-lg, 0 10px 32px rgba(0, 0, 0, 0.08));
}

.healthcare-page-header-transparent {
    background: transparent;
    backdrop-filter: none;
    border: none;
    box-shadow: none;
}

/* Bordered Variant */
.healthcare-page-header-bordered {
    border-bottom: 2px solid var(--glass-border, rgba(255, 255, 255, 0.2));
    border-radius: var(--radius-2xl, 20px) var(--radius-2xl, 20px) 0 0;
}

/* Sticky Header */
.healthcare-page-header-sticky {
    position: sticky;
    top: 0;
    z-index: 1040;
    margin-bottom: 0;
}

/* Header Sizes */
.healthcare-page-header-sm {
    padding: var(--spacing-4, 16px);
    margin-bottom: var(--spacing-4, 16px);
}

.healthcare-page-header-md {
    padding: var(--spacing-6, 24px);
    margin-bottom: var(--spacing-6, 24px);
}

.healthcare-page-header-lg {
    padding: var(--spacing-8, 32px);
    margin-bottom: var(--spacing-8, 32px);
}

.healthcare-page-header-xl {
    padding: var(--spacing-10, 40px);
    margin-bottom: var(--spacing-10, 40px);
}

/* Header Content */
.healthcare-page-header-content {
    position: relative;
    z-index: 1;
}

/* Breadcrumbs */
.healthcare-page-header-breadcrumbs {
    margin-bottom: var(--spacing-4, 16px);
}

.healthcare-breadcrumb-list {
    display: flex;
    align-items: center;
    flex-wrap: wrap;
    gap: var(--spacing-2, 8px);
    list-style: none;
    margin: 0;
    padding: 0;
}

.healthcare-breadcrumb-item {
    display: flex;
    align-items: center;
    gap: var(--spacing-2, 8px);
}

.healthcare-breadcrumb-link {
    display: flex;
    align-items: center;
    gap: var(--spacing-2, 8px);
    color: var(--text-tertiary, #9ca3af);
    text-decoration: none;
    font-size: var(--font-size-sm, 14px);
    padding: var(--spacing-1, 4px) var(--spacing-2, 8px);
    border-radius: var(--radius-lg, 12px);
    transition: all var(--transition-fast, 0.2s ease);
}

.healthcare-breadcrumb-link:hover {
    color: var(--healthcare-primary, #3b82f6);
    background: var(--healthcare-primary-bg, rgba(59, 130, 246, 0.1));
}

.healthcare-breadcrumb-text {
    display: flex;
    align-items: center;
    gap: var(--spacing-2, 8px);
    font-size: var(--font-size-sm, 14px);
    color: var(--text-secondary, #6b7280);
}

.healthcare-breadcrumb-active .healthcare-breadcrumb-text {
    color: var(--text-primary, #1f2937);
    font-weight: var(--font-weight-medium, 500);
}

.healthcare-breadcrumb-separator {
    color: var(--text-tertiary, #9ca3af);
    font-size: 10px;
}

/* Main Header Section */
.healthcare-page-header-main {
    display: flex;
    align-items: flex-start;
    justify-content: space-between;
    gap: var(--spacing-6, 24px);
}

/* Title Section */
.healthcare-page-header-title-section {
    flex: 1;
    min-width: 0;
}

.healthcare-page-header-title-wrapper {
    display: flex;
    align-items: flex-start;
    gap: var(--spacing-4, 16px);
    margin-bottom: var(--spacing-3, 12px);
}

.healthcare-page-header-icon {
    width: 48px;
    height: 48px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--healthcare-primary-bg, rgba(59, 130, 246, 0.1));
    color: var(--healthcare-primary, #3b82f6);
    border-radius: var(--radius-xl, 16px);
    font-size: 20px;
    flex-shrink: 0;
}

.healthcare-page-header-sm .healthcare-page-header-icon {
    width: 40px;
    height: 40px;
    font-size: 18px;
}

.healthcare-page-header-lg .healthcare-page-header-icon {
    width: 56px;
    height: 56px;
    font-size: 24px;
}

.healthcare-page-header-titles {
    flex: 1;
    min-width: 0;
}

.healthcare-page-header-title {
    font-size: var(--font-size-2xl, 24px);
    font-weight: var(--font-weight-bold, 700);
    color: var(--text-primary, #1f2937);
    margin: 0;
    line-height: 1.2;
}

.healthcare-page-header-sm .healthcare-page-header-title {
    font-size: var(--font-size-xl, 20px);
}

.healthcare-page-header-lg .healthcare-page-header-title {
    font-size: var(--font-size-3xl, 30px);
}

.healthcare-page-header-xl .healthcare-page-header-title {
    font-size: var(--font-size-4xl, 36px);
}

.healthcare-page-header-subtitle {
    font-size: var(--font-size-base, 16px);
    color: var(--text-secondary, #6b7280);
    margin: var(--spacing-2, 8px) 0 0 0;
    line-height: 1.5;
}

.healthcare-page-header-sm .healthcare-page-header-subtitle {
    font-size: var(--font-size-sm, 14px);
}

.healthcare-page-header-lg .healthcare-page-header-subtitle {
    font-size: var(--font-size-lg, 18px);
}

/* Header Variants */
.healthcare-page-header-centered {
    text-align: center;
}

.healthcare-page-header-centered .healthcare-page-header-main {
    flex-direction: column;
    align-items: center;
    text-align: center;
}

.healthcare-page-header-minimal .healthcare-page-header-title-wrapper {
    margin-bottom: var(--spacing-2, 8px);
}

.healthcare-page-header-minimal .healthcare-page-header-meta {
    margin-top: var(--spacing-2, 8px);
}

/* Meta Information */
.healthcare-page-header-meta {
    display: flex;
    align-items: center;
    flex-wrap: wrap;
    gap: var(--spacing-4, 16px);
    margin-top: var(--spacing-3, 12px);
}

.healthcare-page-header-meta-item {
    display: flex;
    align-items: center;
    gap: var(--spacing-2, 8px);
    font-size: var(--font-size-sm, 14px);
    color: var(--text-secondary, #6b7280);
}

.healthcare-page-header-meta-label {
    font-weight: var(--font-weight-medium, 500);
}

.healthcare-page-header-meta-value {
    color: var(--text-primary, #1f2937);
}

.healthcare-page-header-meta-status .healthcare-page-header-meta-value {
    padding: var(--spacing-1, 4px) var(--spacing-2, 8px);
    border-radius: var(--radius-full, 9999px);
    font-size: var(--font-size-xs, 12px);
    font-weight: var(--font-weight-semibold, 600);
}

.healthcare-status-success {
    background: var(--healthcare-success-bg, rgba(16, 185, 129, 0.1));
    color: var(--healthcare-success, #10b981);
}

.healthcare-status-warning {
    background: var(--healthcare-warning-bg, rgba(245, 158, 11, 0.1));
    color: var(--healthcare-warning, #f59e0b);
}

.healthcare-status-danger {
    background: var(--healthcare-danger-bg, rgba(239, 68, 68, 0.1));
    color: var(--healthcare-danger, #ef4444);
}

.healthcare-status-info {
    background: var(--healthcare-info-bg, rgba(59, 130, 246, 0.1));
    color: var(--healthcare-info, #3b82f6);
}

/* Actions Section */
.healthcare-page-header-actions {
    display: flex;
    align-items: center;
    gap: var(--spacing-3, 12px);
    flex-shrink: 0;
}

/* Dropdown */
.healthcare-dropdown {
    position: relative;
}

.healthcare-dropdown-toggle {
    display: flex;
    align-items: center;
    gap: var(--spacing-2, 8px);
}

.healthcare-dropdown-arrow {
    font-size: 12px;
    transition: transform var(--transition-fast, 0.2s ease);
}

.healthcare-dropdown.active .healthcare-dropdown-arrow {
    transform: rotate(180deg);
}

.healthcare-dropdown-menu {
    position: absolute;
    top: calc(100% + var(--spacing-2, 8px));
    right: 0;
    min-width: 200px;
    background: var(--glass-bg, rgba(255, 255, 255, 0.95));
    backdrop-filter: var(--glass-blur, blur(20px));
    border: 1px solid var(--glass-border, rgba(255, 255, 255, 0.2));
    border-radius: var(--radius-xl, 16px);
    box-shadow: var(--glass-shadow-xl, 0 20px 48px rgba(0, 0, 0, 0.15));
    padding: var(--spacing-2, 8px);
    z-index: 1050;
    opacity: 0;
    visibility: hidden;
    transform: translateY(-10px);
    transition: all var(--transition-base, 0.3s ease);
}

.healthcare-dropdown.active .healthcare-dropdown-menu {
    opacity: 1;
    visibility: visible;
    transform: translateY(0);
}

.healthcare-dropdown-item {
    display: flex;
    align-items: center;
    gap: var(--spacing-2, 8px);
    padding: var(--spacing-2, 8px) var(--spacing-3, 12px);
    border-radius: var(--radius-lg, 12px);
    text-decoration: none;
    color: var(--text-secondary, #6b7280);
    font-size: var(--font-size-sm, 14px);
    transition: all var(--transition-fast, 0.2s ease);
}

.healthcare-dropdown-item:hover {
    background: var(--healthcare-primary-bg, rgba(59, 130, 246, 0.1));
    color: var(--healthcare-primary, #3b82f6);
}

.healthcare-dropdown-separator {
    height: 1px;
    background: var(--glass-border, rgba(255, 255, 255, 0.2));
    margin: var(--spacing-2, 8px) 0;
}

/* Loading State */
.healthcare-page-header-loading {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: var(--glass-bg, rgba(255, 255, 255, 0.8));
    backdrop-filter: var(--glass-blur, blur(20px));
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: inherit;
    z-index: 2;
}

.healthcare-loading-spinner {
    width: 32px;
    height: 32px;
    border: 3px solid var(--healthcare-primary-light, #60a5fa);
    border-top-color: var(--healthcare-primary, #3b82f6);
    border-radius: 50%;
    animation: healthcare-header-spin 1s linear infinite;
}

@keyframes healthcare-header-spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

/* =============================================
   Responsive Design
   ============================================= */

@media (max-width: 768px) {
    .healthcare-page-header {
        padding: var(--spacing-4, 16px);
        margin-bottom: var(--spacing-4, 16px);
    }
    
    .healthcare-page-header-main {
        flex-direction: column;
        align-items: stretch;
        gap: var(--spacing-4, 16px);
    }
    
    .healthcare-page-header-actions {
        justify-content: flex-start;
        flex-wrap: wrap;
    }
    
    .healthcare-breadcrumb-list {
        flex-wrap: nowrap;
        overflow-x: auto;
        scrollbar-width: none;
        -ms-overflow-style: none;
    }
    
    .healthcare-breadcrumb-list::-webkit-scrollbar {
        display: none;
    }
    
    .healthcare-page-header-meta {
        flex-direction: column;
        align-items: flex-start;
        gap: var(--spacing-2, 8px);
    }
    
    .healthcare-page-header-title {
        font-size: var(--font-size-xl, 20px);
    }
    
    .healthcare-page-header-subtitle {
        font-size: var(--font-size-sm, 14px);
    }
}

@media (max-width: 480px) {
    .healthcare-page-header-actions {
        width: 100%;
    }
    
    .healthcare-page-header-actions .healthcare-btn {
        flex: 1;
        justify-content: center;
    }
    
    .healthcare-dropdown-menu {
        left: 0;
        right: 0;
        min-width: auto;
    }
}

/* =============================================
   Dark Mode Support
   ============================================= */

@media (prefers-color-scheme: dark) {
    .healthcare-page-header-glass {
        background: rgba(17, 24, 39, 0.95);
        border-color: rgba(75, 85, 99, 0.3);
    }
    
    .healthcare-page-header-solid {
        background: var(--neutral-900, #111827);
        border-color: var(--neutral-700, #374151);
    }
    
    .healthcare-page-header-title {
        color: var(--neutral-white, #ffffff);
    }
    
    .healthcare-page-header-subtitle {
        color: var(--neutral-300, #d1d5db);
    }
    
    .healthcare-dropdown-menu {
        background: rgba(17, 24, 39, 0.95);
        border-color: rgba(75, 85, 99, 0.3);
    }
}

/* =============================================
   Accessibility Enhancements
   ============================================= */

.healthcare-page-header:focus-within {
    outline: 2px solid var(--healthcare-primary, #3b82f6);
    outline-offset: 4px;
}

.healthcare-breadcrumb-link:focus-visible,
.healthcare-dropdown-item:focus-visible {
    outline: 2px solid var(--healthcare-primary, #3b82f6);
    outline-offset: 2px;
}

/* Reduced motion */
@media (prefers-reduced-motion: reduce) {
    .healthcare-page-header,
    .healthcare-breadcrumb-link,
    .healthcare-dropdown-menu,
    .healthcare-dropdown-arrow {
        transition: none;
    }
    
    .healthcare-loading-spinner {
        animation: none;
    }
}

/* High contrast mode */
@media (prefers-contrast: high) {
    .healthcare-page-header-glass,
    .healthcare-page-header-solid {
        border-width: 2px;
    }
    
    .healthcare-page-header-title {
        font-weight: var(--font-weight-black, 900);
    }
}
</style>

<script>
// Healthcare Page Header Component JavaScript
document.addEventListener('DOMContentLoaded', function() {
    initializeHealthcarePageHeader();
});

function initializeHealthcarePageHeader() {
    // Initialize dropdown toggles
    document.querySelectorAll('[data-dropdown-toggle]').forEach(toggle => {
        toggle.addEventListener('click', function(e) {
            e.preventDefault();
            e.stopPropagation();
            
            const dropdown = this.closest('.healthcare-dropdown');
            toggleDropdown(dropdown);
        });
    });
    
    // Close dropdowns when clicking outside
    document.addEventListener('click', function(e) {
        if (!e.target.closest('.healthcare-dropdown')) {
            document.querySelectorAll('.healthcare-dropdown.active').forEach(dropdown => {
                toggleDropdown(dropdown, false);
            });
        }
    });
    
    // Initialize keyboard navigation for dropdowns
    document.querySelectorAll('.healthcare-dropdown').forEach(dropdown => {
        const toggle = dropdown.querySelector('[data-dropdown-toggle]');
        const menu = dropdown.querySelector('.healthcare-dropdown-menu');
        const items = dropdown.querySelectorAll('.healthcare-dropdown-item');
        
        toggle.addEventListener('keydown', function(e) {
            if (e.key === 'Enter' || e.key === ' ') {
                e.preventDefault();
                toggleDropdown(dropdown);
            } else if (e.key === 'ArrowDown') {
                e.preventDefault();
                toggleDropdown(dropdown, true);
                if (items.length > 0) {
                    items[0].focus();
                }
            }
        });
        
        items.forEach((item, index) => {
            item.addEventListener('keydown', function(e) {
                if (e.key === 'ArrowDown') {
                    e.preventDefault();
                    const nextIndex = (index + 1) % items.length;
                    items[nextIndex].focus();
                } else if (e.key === 'ArrowUp') {
                    e.preventDefault();
                    const prevIndex = index === 0 ? items.length - 1 : index - 1;
                    items[prevIndex].focus();
                } else if (e.key === 'Escape') {
                    e.preventDefault();
                    toggleDropdown(dropdown, false);
                    toggle.focus();
                }
            });
        });
    });
}

function toggleDropdown(dropdown, forceState = null) {
    const isActive = dropdown.classList.contains('active');
    const shouldActivate = forceState !== null ? forceState : !isActive;
    
    // Close all other dropdowns
    document.querySelectorAll('.healthcare-dropdown.active').forEach(otherDropdown => {
        if (otherDropdown !== dropdown) {
            otherDropdown.classList.remove('active');
        }
    });
    
    if (shouldActivate) {
        dropdown.classList.add('active');
    } else {
        dropdown.classList.remove('active');
    }
    
    // Update ARIA state
    const toggle = dropdown.querySelector('[data-dropdown-toggle]');
    if (toggle) {
        toggle.setAttribute('aria-expanded', shouldActivate.toString());
    }
}

function setHeaderLoading(loading = true) {
    const headers = document.querySelectorAll('.healthcare-page-header');
    headers.forEach(header => {
        const loadingElement = header.querySelector('.healthcare-page-header-loading');
        if (loadingElement) {
            loadingElement.style.display = loading ? 'flex' : 'none';
        }
    });
}

function updateHeaderMeta(selector, newMeta) {
    const header = document.querySelector(selector);
    if (header) {
        const metaContainer = header.querySelector('.healthcare-page-header-meta');
        if (metaContainer && newMeta) {
            let metaHTML = '';
            newMeta.forEach(item => {
                metaHTML += `
                    <div class="healthcare-page-header-meta-item${item.type ? ` healthcare-page-header-meta-${item.type}` : ''}">
                        ${item.icon ? `<i class="${item.icon}" aria-hidden="true"></i>` : ''}
                        ${item.label ? `<span class="healthcare-page-header-meta-label">${item.label}:</span>` : ''}
                        <span class="healthcare-page-header-meta-value${item.type === 'status' ? ` healthcare-status-${item.variant || 'default'}` : ''}">
                            ${item.value}
                        </span>
                    </div>
                `;
            });
            metaContainer.innerHTML = metaHTML;
        }
    }
}

// Export utility functions
window.HealthcarePageHeader = {
    toggleDropdown: toggleDropdown,
    setLoading: setHeaderLoading,
    updateMeta: updateHeaderMeta
};
</script>

<!-- Usage Examples (hidden) -->
<div style="display: none;">
    <!-- Basic Header -->
    {% include 'components/page_header.html' with title="Dashboard" subtitle="Welcome to HealthSphere AI" %}
    
    <!-- Header with Breadcrumbs -->
    {% include 'components/page_header.html' with 
        title="Patient Profile" 
        subtitle="John Doe - ID: 12345" 
        breadcrumbs=breadcrumbs_example %}
    
    <!-- Header with Actions -->
    {% include 'components/page_header.html' with 
        title="Appointments" 
        subtitle="Manage patient appointments" 
        actions=actions_example %}
    
    <!-- Full Featured Header -->
    {% include 'components/page_header.html' with 
        title="Analytics Dashboard" 
        subtitle="Health insights and reporting" 
        icon="fas fa-chart-line"
        breadcrumbs=breadcrumbs_example 
        actions=actions_example 
        meta=meta_example 
        variant="default" 
        size="lg" %}
    
    <!-- JavaScript Usage -->
    <script>
        // Set loading state
        // HealthcarePageHeader.setLoading(true);
        
        // Update meta information
        // HealthcarePageHeader.updateMeta('.healthcare-page-header', [
        //     {label: 'Last Updated', value: 'Just now', icon: 'fas fa-clock'},
        //     {label: 'Status', value: 'Online', type: 'status', variant: 'success'}
        // ]);
    </script>
</div>
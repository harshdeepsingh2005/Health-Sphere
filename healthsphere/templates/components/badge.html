{% comment %}
Badge Component - HealthSphere AI
==================================

Usage Examples:
{% include 'components/badge.html' with type="success" text="Active" %}
{% include 'components/badge.html' with type="warning" text="Pending" icon="fas fa-clock" %}
{% include 'components/badge.html' with type="critical" text="Critical" size="large" pulse=True %}
{% include 'components/badge.html' with type="info" text="Updated" dot=True %}

Parameters:
- type: "success", "warning", "critical", "danger", "info", "neutral" (required)
- text: Badge text content (required)
- icon: Font Awesome icon class (optional)
- size: "xs", "sm", "md", "lg", "xl" (default: md)
- variant: "solid", "soft", "outline", "dot" (default: solid)
- dot: Boolean to show status dot (optional)
- pulse: Boolean to add pulse animation (optional)
- dismissible: Boolean to add close button (optional)
- rounded: Boolean for pill-shaped badge (default: True)
- uppercase: Boolean to uppercase text (default: True)
- href: Make badge clickable with link (optional)
- count: Numeric count for notification badges (optional)

Badge Types:
- success: Green for completed, active, approved states
- warning: Orange for pending, attention needed states  
- critical/danger: Red for urgent, error, failed states
- info: Blue for informational, updated states
- neutral: Gray for inactive, draft, default states

{% endcomment %}

{% if href %}<a href="{{ href }}" class="healthcare-badge-link">{% endif %}
<span class="healthcare-badge healthcare-badge-{{ type|default:'neutral' }} healthcare-badge-{{ variant|default:'solid' }} healthcare-badge-{{ size|default:'md' }}{% if rounded %} healthcare-badge-rounded{% endif %}{% if uppercase %} healthcare-badge-uppercase{% endif %}{% if pulse %} healthcare-badge-pulse{% endif %}{% if dismissible %} healthcare-badge-dismissible{% endif %}{% if count %} healthcare-badge-count{% endif %}"
      {% if dismissible %}data-dismissible{% endif %}
      {% if count %}data-count="{{ count }}"{% endif %}>
    
    {% if dot %}
    <span class="healthcare-badge-dot"></span>
    {% endif %}
    
    {% if icon %}
    <i class="{{ icon }} healthcare-badge-icon"></i>
    {% endif %}
    
    {% if count %}
    <span class="healthcare-badge-count-value">{{ count }}</span>
    {% elif text %}
    <span class="healthcare-badge-text">{{ text }}</span>
    {% endif %}
    
    {% if dismissible %}
    <button class="healthcare-badge-dismiss" aria-label="Dismiss" data-dismiss-badge>
        <i class="fas fa-times"></i>
    </button>
    {% endif %}
</span>
{% if href %}</a>{% endif %}

<style>
/* =============================================
   Healthcare Badge Component Styles
   ============================================= */

/* Base Badge Styles */
.healthcare-badge {
    display: inline-flex;
    align-items: center;
    gap: var(--spacing-1, 4px);
    padding: var(--spacing-1, 4px) var(--spacing-2, 8px);
    font-size: var(--font-size-xs, 12px);
    font-weight: var(--font-weight-medium, 500);
    line-height: 1;
    border: 1px solid transparent;
    border-radius: var(--radius-md, 8px);
    background: var(--glass-bg, rgba(255, 255, 255, 0.8));
    backdrop-filter: var(--glass-blur, blur(10px));
    box-shadow: var(--glass-shadow-sm, 0 2px 8px rgba(0, 0, 0, 0.1));
    transition: all var(--transition-fast, 0.2s ease);
    position: relative;
    overflow: hidden;
    white-space: nowrap;
    vertical-align: middle;
}

/* Badge Link Wrapper */
.healthcare-badge-link {
    text-decoration: none;
    color: inherit;
}

.healthcare-badge-link:hover .healthcare-badge {
    transform: translateY(-1px);
    box-shadow: var(--glass-shadow-md, 0 4px 16px rgba(0, 0, 0, 0.15));
}

/* Rounded Badge */
.healthcare-badge-rounded {
    border-radius: var(--radius-full, 9999px);
}

/* Uppercase Text */
.healthcare-badge-uppercase .healthcare-badge-text {
    text-transform: uppercase;
    letter-spacing: 0.05em;
}

/* =============================================
   Badge Variants
   ============================================= */

/* Solid Variants */
.healthcare-badge-solid.healthcare-badge-success {
    background: linear-gradient(135deg, var(--healthcare-success, #10b981), var(--healthcare-success-light, #34d399));
    color: var(--neutral-white, #ffffff);
    border-color: var(--healthcare-success, #10b981);
}

.healthcare-badge-solid.healthcare-badge-warning {
    background: linear-gradient(135deg, var(--healthcare-warning, #f59e0b), var(--healthcare-warning-light, #fbbf24));
    color: var(--neutral-white, #ffffff);
    border-color: var(--healthcare-warning, #f59e0b);
}

.healthcare-badge-solid.healthcare-badge-critical,
.healthcare-badge-solid.healthcare-badge-danger {
    background: linear-gradient(135deg, var(--healthcare-danger, #ef4444), var(--healthcare-danger-light, #f87171));
    color: var(--neutral-white, #ffffff);
    border-color: var(--healthcare-danger, #ef4444);
}

.healthcare-badge-solid.healthcare-badge-info {
    background: linear-gradient(135deg, var(--healthcare-info, #3b82f6), var(--healthcare-info-light, #60a5fa));
    color: var(--neutral-white, #ffffff);
    border-color: var(--healthcare-info, #3b82f6);
}

.healthcare-badge-solid.healthcare-badge-neutral {
    background: var(--neutral-100, #f3f4f6);
    color: var(--text-secondary, #6b7280);
    border-color: var(--neutral-200, #e5e7eb);
}

/* Soft Variants */
.healthcare-badge-soft.healthcare-badge-success {
    background: var(--healthcare-success-bg, rgba(16, 185, 129, 0.1));
    color: var(--healthcare-success, #10b981);
    border-color: var(--healthcare-success-light, #34d399);
}

.healthcare-badge-soft.healthcare-badge-warning {
    background: var(--healthcare-warning-bg, rgba(245, 158, 11, 0.1));
    color: var(--healthcare-warning, #f59e0b);
    border-color: var(--healthcare-warning-light, #fbbf24);
}

.healthcare-badge-soft.healthcare-badge-critical,
.healthcare-badge-soft.healthcare-badge-danger {
    background: var(--healthcare-danger-bg, rgba(239, 68, 68, 0.1));
    color: var(--healthcare-danger, #ef4444);
    border-color: var(--healthcare-danger-light, #f87171);
}

.healthcare-badge-soft.healthcare-badge-info {
    background: var(--healthcare-info-bg, rgba(59, 130, 246, 0.1));
    color: var(--healthcare-info, #3b82f6);
    border-color: var(--healthcare-info-light, #60a5fa);
}

.healthcare-badge-soft.healthcare-badge-neutral {
    background: var(--neutral-50, #f9fafb);
    color: var(--text-secondary, #6b7280);
    border-color: var(--neutral-200, #e5e7eb);
}

/* Outline Variants */
.healthcare-badge-outline.healthcare-badge-success {
    background: transparent;
    color: var(--healthcare-success, #10b981);
    border-color: var(--healthcare-success, #10b981);
    backdrop-filter: none;
}

.healthcare-badge-outline.healthcare-badge-warning {
    background: transparent;
    color: var(--healthcare-warning, #f59e0b);
    border-color: var(--healthcare-warning, #f59e0b);
    backdrop-filter: none;
}

.healthcare-badge-outline.healthcare-badge-critical,
.healthcare-badge-outline.healthcare-badge-danger {
    background: transparent;
    color: var(--healthcare-danger, #ef4444);
    border-color: var(--healthcare-danger, #ef4444);
    backdrop-filter: none;
}

.healthcare-badge-outline.healthcare-badge-info {
    background: transparent;
    color: var(--healthcare-info, #3b82f6);
    border-color: var(--healthcare-info, #3b82f6);
    backdrop-filter: none;
}

.healthcare-badge-outline.healthcare-badge-neutral {
    background: transparent;
    color: var(--text-secondary, #6b7280);
    border-color: var(--neutral-300, #d1d5db);
    backdrop-filter: none;
}

/* Dot Variants */
.healthcare-badge-dot {
    padding-left: var(--spacing-1, 4px);
}

.healthcare-badge-dot.healthcare-badge-success,
.healthcare-badge-dot.healthcare-badge-warning,
.healthcare-badge-dot.healthcare-badge-critical,
.healthcare-badge-dot.healthcare-badge-danger,
.healthcare-badge-dot.healthcare-badge-info {
    background: var(--glass-bg, rgba(255, 255, 255, 0.8));
    color: var(--text-primary, #1f2937);
    border-color: var(--glass-border, rgba(255, 255, 255, 0.2));
}

/* =============================================
   Badge Sizes
   ============================================= */

.healthcare-badge-xs {
    padding: 2px var(--spacing-1, 4px);
    font-size: 10px;
    gap: 2px;
}

.healthcare-badge-sm {
    padding: var(--spacing-1, 4px) var(--spacing-2, 8px);
    font-size: var(--font-size-xs, 12px);
    gap: var(--spacing-1, 4px);
}

.healthcare-badge-md {
    padding: var(--spacing-1, 4px) var(--spacing-2, 8px);
    font-size: var(--font-size-xs, 12px);
    gap: var(--spacing-1, 4px);
}

.healthcare-badge-lg {
    padding: var(--spacing-2, 8px) var(--spacing-3, 12px);
    font-size: var(--font-size-sm, 14px);
    gap: var(--spacing-2, 8px);
}

.healthcare-badge-xl {
    padding: var(--spacing-2, 8px) var(--spacing-4, 16px);
    font-size: var(--font-size-base, 16px);
    gap: var(--spacing-2, 8px);
}

/* =============================================
   Badge Elements
   ============================================= */

/* Status Dot */
.healthcare-badge-dot {
    width: 6px;
    height: 6px;
    border-radius: 50%;
    background: currentColor;
    flex-shrink: 0;
}

.healthcare-badge-success .healthcare-badge-dot {
    background: var(--healthcare-success, #10b981);
}

.healthcare-badge-warning .healthcare-badge-dot {
    background: var(--healthcare-warning, #f59e0b);
}

.healthcare-badge-critical .healthcare-badge-dot,
.healthcare-badge-danger .healthcare-badge-dot {
    background: var(--healthcare-danger, #ef4444);
}

.healthcare-badge-info .healthcare-badge-dot {
    background: var(--healthcare-info, #3b82f6);
}

.healthcare-badge-neutral .healthcare-badge-dot {
    background: var(--text-secondary, #6b7280);
}

/* Badge Icon */
.healthcare-badge-icon {
    font-size: 0.8em;
    flex-shrink: 0;
}

/* Badge Text */
.healthcare-badge-text {
    flex: 1;
    min-width: 0;
}

/* Count Badge */
.healthcare-badge-count {
    min-width: 18px;
    height: 18px;
    padding: 0 var(--spacing-1, 4px);
    border-radius: var(--radius-full, 9999px);
    justify-content: center;
    font-weight: var(--font-weight-semibold, 600);
    font-size: 10px;
}

.healthcare-badge-count-value {
    line-height: 1;
}

/* Dismiss Button */
.healthcare-badge-dismissible {
    padding-right: var(--spacing-1, 4px);
}

.healthcare-badge-dismiss {
    background: none;
    border: none;
    color: inherit;
    cursor: pointer;
    padding: var(--spacing-1, 4px);
    margin: 0 -2px 0 var(--spacing-1, 4px);
    border-radius: var(--radius-sm, 4px);
    transition: all var(--transition-fast, 0.2s ease);
    opacity: 0.7;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.8em;
}

.healthcare-badge-dismiss:hover {
    opacity: 1;
    background: rgba(0, 0, 0, 0.1);
}

/* =============================================
   Badge Animations
   ============================================= */

/* Pulse Animation */
.healthcare-badge-pulse {
    animation: healthcare-badge-pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
}

@keyframes healthcare-badge-pulse {
    0%, 100% {
        opacity: 1;
    }
    50% {
        opacity: 0.7;
    }
}

/* Fade In Animation */
.healthcare-badge-fade-in {
    animation: healthcare-badge-fade-in 0.3s ease-out;
}

@keyframes healthcare-badge-fade-in {
    from {
        opacity: 0;
        transform: scale(0.8);
    }
    to {
        opacity: 1;
        transform: scale(1);
    }
}

/* Slide Out Animation */
.healthcare-badge-slide-out {
    animation: healthcare-badge-slide-out 0.3s ease-in forwards;
}

@keyframes healthcare-badge-slide-out {
    to {
        opacity: 0;
        transform: translateX(20px);
        max-width: 0;
        padding: 0;
        margin: 0;
        overflow: hidden;
    }
}

/* =============================================
   Badge Positions (for absolute positioning)
   ============================================= */

.healthcare-badge-positioned {
    position: absolute;
    z-index: 10;
}

.healthcare-badge-top-right {
    top: -6px;
    right: -6px;
}

.healthcare-badge-top-left {
    top: -6px;
    left: -6px;
}

.healthcare-badge-bottom-right {
    bottom: -6px;
    right: -6px;
}

.healthcare-badge-bottom-left {
    bottom: -6px;
    left: -6px;
}

/* =============================================
   Responsive Design
   ============================================= */

@media (max-width: 768px) {
    .healthcare-badge-lg {
        padding: var(--spacing-1, 4px) var(--spacing-2, 8px);
        font-size: var(--font-size-xs, 12px);
    }
    
    .healthcare-badge-xl {
        padding: var(--spacing-2, 8px) var(--spacing-3, 12px);
        font-size: var(--font-size-sm, 14px);
    }
}

/* =============================================
   Dark Mode Support
   ============================================= */

@media (prefers-color-scheme: dark) {
    .healthcare-badge-soft.healthcare-badge-neutral {
        background: rgba(31, 41, 55, 0.8);
        color: var(--neutral-300, #d1d5db);
        border-color: rgba(75, 85, 99, 0.3);
    }
    
    .healthcare-badge-solid.healthcare-badge-neutral {
        background: rgba(17, 24, 39, 0.8);
        color: var(--neutral-300, #d1d5db);
        border-color: rgba(75, 85, 99, 0.3);
    }
}

/* =============================================
   Print Styles
   ============================================= */

@media print {
    .healthcare-badge {
        background: transparent !important;
        color: #000 !important;
        border: 1px solid #000 !important;
        box-shadow: none !important;
    }
    
    .healthcare-badge-dismiss {
        display: none !important;
    }
}

/* =============================================
   Accessibility
   ============================================= */

.healthcare-badge:focus-within {
    outline: 2px solid var(--healthcare-primary, #3b82f6);
    outline-offset: 2px;
}

/* Reduced motion */
@media (prefers-reduced-motion: reduce) {
    .healthcare-badge-pulse {
        animation: none;
    }
    
    .healthcare-badge {
        transition: none;
    }
}

/* High contrast mode */
@media (prefers-contrast: high) {
    .healthcare-badge {
        border-width: 2px;
    }
}
</style>

<script>
// Healthcare Badge Component JavaScript
document.addEventListener('DOMContentLoaded', function() {
    initializeHealthcareBadges();
});

function initializeHealthcareBadges() {
    // Initialize dismissible badges
    document.querySelectorAll('[data-dismiss-badge]').forEach(dismissBtn => {
        dismissBtn.addEventListener('click', function(e) {
            e.preventDefault();
            e.stopPropagation();
            
            const badge = this.closest('.healthcare-badge');
            dismissBadge(badge);
        });
    });
    
    // Add entrance animation to new badges
    document.querySelectorAll('.healthcare-badge').forEach((badge, index) => {
        // Staggered entrance animation
        setTimeout(() => {
            badge.classList.add('healthcare-badge-fade-in');
        }, index * 50);
    });
}

function dismissBadge(badge) {
    if (!badge) return;
    
    // Add slide out animation
    badge.classList.add('healthcare-badge-slide-out');
    
    // Dispatch custom event
    const event = new CustomEvent('badgeDismiss', {
        detail: {
            badge: badge,
            type: badge.classList.contains('healthcare-badge-success') ? 'success' :
                  badge.classList.contains('healthcare-badge-warning') ? 'warning' :
                  badge.classList.contains('healthcare-badge-critical') ? 'critical' :
                  badge.classList.contains('healthcare-badge-danger') ? 'danger' :
                  badge.classList.contains('healthcare-badge-info') ? 'info' : 'neutral'
        }
    });
    badge.dispatchEvent(event);
    
    // Remove badge after animation
    setTimeout(() => {
        if (badge.parentNode) {
            badge.parentNode.removeChild(badge);
        }
    }, 300);
}

function createBadge(type, text, options = {}) {
    const badge = document.createElement('span');
    badge.className = `healthcare-badge healthcare-badge-${type} healthcare-badge-${options.variant || 'solid'} healthcare-badge-${options.size || 'md'}`;
    
    if (options.rounded !== false) badge.classList.add('healthcare-badge-rounded');
    if (options.uppercase !== false) badge.classList.add('healthcare-badge-uppercase');
    if (options.pulse) badge.classList.add('healthcare-badge-pulse');
    if (options.dismissible) badge.classList.add('healthcare-badge-dismissible');
    
    let content = '';
    
    if (options.dot) {
        content += '<span class="healthcare-badge-dot"></span>';
    }
    
    if (options.icon) {
        content += `<i class="${options.icon} healthcare-badge-icon"></i>`;
    }
    
    if (options.count) {
        content += `<span class="healthcare-badge-count-value">${options.count}</span>`;
    } else {
        content += `<span class="healthcare-badge-text">${text}</span>`;
    }
    
    if (options.dismissible) {
        content += '<button class="healthcare-badge-dismiss" aria-label="Dismiss" data-dismiss-badge><i class="fas fa-times"></i></button>';
    }
    
    badge.innerHTML = content;
    badge.classList.add('healthcare-badge-fade-in');
    
    return badge;
}

function updateBadgeCount(badge, count) {
    const countElement = badge.querySelector('.healthcare-badge-count-value');
    if (countElement) {
        countElement.textContent = count;
        badge.dataset.count = count;
        
        // Add pulse animation for count updates
        badge.classList.add('healthcare-badge-pulse');
        setTimeout(() => {
            badge.classList.remove('healthcare-badge-pulse');
        }, 2000);
    }
}

// Export utility functions
window.HealthcareBadge = {
    create: createBadge,
    dismiss: dismissBadge,
    updateCount: updateBadgeCount
};
</script>

<!-- Usage Examples (hidden) -->
<div style="display: none;">
    <!-- Basic Status Badges -->
    <div class="example-badges" style="display: flex; gap: 8px; padding: 16px; flex-wrap: wrap;">
        {% include 'components/badge.html' with type="success" text="Active" %}
        {% include 'components/badge.html' with type="warning" text="Pending" %}
        {% include 'components/badge.html' with type="critical" text="Critical" %}
        {% include 'components/badge.html' with type="info" text="Updated" %}
        {% include 'components/badge.html' with type="neutral" text="Draft" %}
    </div>
    
    <!-- Badge Variants -->
    <div class="example-variants" style="display: flex; gap: 8px; padding: 16px; flex-wrap: wrap;">
        {% include 'components/badge.html' with type="success" text="Solid" variant="solid" %}
        {% include 'components/badge.html' with type="success" text="Soft" variant="soft" %}
        {% include 'components/badge.html' with type="success" text="Outline" variant="outline" %}
    </div>
    
    <!-- Badge with Icons -->
    <div class="example-icons" style="display: flex; gap: 8px; padding: 16px; flex-wrap: wrap;">
        {% include 'components/badge.html' with type="success" text="Completed" icon="fas fa-check" %}
        {% include 'components/badge.html' with type="warning" text="Pending" icon="fas fa-clock" %}
        {% include 'components/badge.html' with type="critical" text="Error" icon="fas fa-exclamation-triangle" %}
        {% include 'components/badge.html' with type="info" text="New" icon="fas fa-info-circle" %}
    </div>
    
    <!-- Badge Sizes -->
    <div class="example-sizes" style="display: flex; align-items: center; gap: 8px; padding: 16px;">
        {% include 'components/badge.html' with type="info" text="XS" size="xs" %}
        {% include 'components/badge.html' with type="info" text="SM" size="sm" %}
        {% include 'components/badge.html' with type="info" text="MD" size="md" %}
        {% include 'components/badge.html' with type="info" text="LG" size="lg" %}
        {% include 'components/badge.html' with type="info" text="XL" size="xl" %}
    </div>
    
    <!-- Special Badges -->
    <div class="example-special" style="display: flex; gap: 8px; padding: 16px; flex-wrap: wrap;">
        {% include 'components/badge.html' with type="success" text="Online" dot=True %}
        {% include 'components/badge.html' with type="critical" text="Alert" pulse=True %}
        {% include 'components/badge.html' with type="info" text="Notification" dismissible=True %}
        {% include 'components/badge.html' with type="warning" count="5" %}
    </div>
</div>
{% extends "base.html" %}
{% load static %}

{% block title %}{{ patient.get_full_name }} — Admin Portal | HealthSphere AI{% endblock %}

{% block breadcrumb %}
<li class="breadcrumb-item"><a href="{% url 'admin_portal:patients' %}" class="breadcrumb-link">Patients</a></li>
<li class="breadcrumb-item breadcrumb-current">{{ patient.get_full_name }}</li>
{% endblock %}

{% block content %}
<div style="display: flex; align-items: center; gap: 1.25rem; background: linear-gradient(135deg, #0f172a, #1e293b); border-radius: var(--radius-xl); padding: 1.75rem; margin-bottom: 1.5rem; color: white;">
    <div style="width: 68px; height: 68px; border-radius: 50%; background: linear-gradient(135deg, #3b82f6, #8b5cf6); display: flex; align-items: center; justify-content: center; font-size: 1.5rem; font-weight: 800; flex-shrink: 0;">
        {{ patient.first_name|first|upper }}{{ patient.last_name|first|upper }}
    </div>
    <div>
        <div style="font-size: 1.5rem; font-weight: 700;">{{ patient.get_full_name|default:patient.username }}</div>
        <div style="opacity: .7; font-size: .875rem; margin-top: .2rem;">{{ patient.email }} · {{ patient.phone|default:"—" }}</div>
        {% if current_admission %}
        <div style="margin-top: .5rem; display: inline-flex; align-items: center; gap: .3rem; background: rgba(16,185,129,.2); border: 1px solid rgba(16,185,129,.4); border-radius: 999px; padding: .2rem .75rem; font-size: .75rem; font-weight: 700; color: #6ee7b7;">
            <i class="fas fa-circle" style="font-size: .4rem;"></i> Currently Admitted
        </div>
        {% endif %}
    </div>
</div>

<!-- Admissions Table -->
<div style="background: white; border: 1px solid var(--neutral-100); border-radius: var(--radius-xl); overflow: hidden; box-shadow: 0 1px 5px rgba(0,0,0,.04);">
    <div style="padding: 1.25rem 1.5rem; border-bottom: 1px solid var(--neutral-100); font-weight: 700; font-size: .9375rem; color: var(--neutral-900);">
        <i class="fas fa-hospital-alt" style="color: var(--healthcare-primary); margin-right: .5rem;"></i>Admission Records
    </div>
    {% if admissions %}
    <table style="width: 100%; border-collapse: collapse;">
        <thead style="background: var(--neutral-50);">
            <tr>
                <th style="padding: .75rem 1.25rem; text-align: left; font-size: .75rem; font-weight: 700; text-transform: uppercase; letter-spacing: .05em; color: var(--neutral-500); border-bottom: 1px solid var(--neutral-100);">Type</th>
                <th style="padding: .75rem 1.25rem; text-align: left; font-size: .75rem; font-weight: 700; text-transform: uppercase; letter-spacing: .05em; color: var(--neutral-500); border-bottom: 1px solid var(--neutral-100);">Diagnosis</th>
                <th style="padding: .75rem 1.25rem; text-align: left; font-size: .75rem; font-weight: 700; text-transform: uppercase; letter-spacing: .05em; color: var(--neutral-500); border-bottom: 1px solid var(--neutral-100);">Doctor</th>
                <th style="padding: .75rem 1.25rem; text-align: left; font-size: .75rem; font-weight: 700; text-transform: uppercase; letter-spacing: .05em; color: var(--neutral-500); border-bottom: 1px solid var(--neutral-100);">Admitted</th>
                <th style="padding: .75rem 1.25rem; text-align: left; font-size: .75rem; font-weight: 700; text-transform: uppercase; letter-spacing: .05em; color: var(--neutral-500); border-bottom: 1px solid var(--neutral-100);">Discharged</th>
                <th style="padding: .75rem 1.25rem; text-align: left; font-size: .75rem; font-weight: 700; text-transform: uppercase; letter-spacing: .05em; color: var(--neutral-500); border-bottom: 1px solid var(--neutral-100);">Status</th>
            </tr>
        </thead>
        <tbody>
            {% for adm in admissions %}
            <tr style="border-bottom: 1px solid var(--neutral-50);">
                <td style="padding: .875rem 1.25rem; font-size: .875rem; color: var(--neutral-700);">{{ adm.get_admission_type_display }}</td>
                <td style="padding: .875rem 1.25rem; font-size: .875rem; color: var(--neutral-700);">{{ adm.diagnosis|default:"—" }}</td>
                <td style="padding: .875rem 1.25rem; font-size: .875rem; color: var(--neutral-700);">{{ adm.attending_doctor.get_full_name|default:"—" }}</td>
                <td style="padding: .875rem 1.25rem; font-size: .875rem; color: var(--neutral-700);">{{ adm.admission_date|date:"M j, Y" }}</td>
                <td style="padding: .875rem 1.25rem; font-size: .875rem; color: var(--neutral-700);">{{ adm.discharge_date|date:"M j, Y"|default:"—" }}</td>
                <td style="padding: .875rem 1.25rem;">
                    <span style="display: inline-flex; align-items: center; padding: .2rem .625rem; border-radius: 999px; font-size: .7rem; font-weight: 700; background: {% if adm.status == 'admitted' %}rgba(16,185,129,.12){% else %}rgba(100,116,139,.1){% endif %}; color: {% if adm.status == 'admitted' %}#059669{% else %}#64748b{% endif %};">
                        {{ adm.get_status_display }}
                    </span>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <div style="text-align: center; padding: 2.5rem; color: var(--neutral-400);">No admission records found.</div>
    {% endif %}
</div>

<div style="margin-top: 1.25rem;">
    <a href="{% url 'admin_portal:patients' %}" style="color: var(--healthcare-primary); font-size: .875rem; font-weight: 500; text-decoration: none;">← Back to Patients</a>
</div>
{% endblock %}

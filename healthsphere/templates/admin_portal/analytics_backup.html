{% extends "base_simple.html" %}
{% load static %}

{% block title %}Analytics Dashboard - HealthSphere AI{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/bento-grid.css' %}">
<style>
.gradient-chart { background: linear-gradient(135deg, #A8C5E8, #b8d4f0); }
.gradient-stats { background: linear-gradient(135deg, #A8C5A8, #b8d4b8); }
.gradient-time { background: linear-gradient(135deg, #E89B87, #f0b097); }
.gradient-revenue { background: linear-gradient(135deg, #F0C3A0, #f8d3b0); }

.tab-navigation {
    display: flex;
    gap: var(--spacing-2);
    margin-bottom: var(--spacing-6);
    border-bottom: 2px solid var(--glass-border);
}

.tab-button {
    background: transparent;
    border: none;
    padding: var(--spacing-3) var(--spacing-6);
    color: var(--text-secondary);
    font-weight: var(--font-weight-medium);
    cursor: pointer;
    transition: all var(--transition-fast);
    border-bottom: 2px solid transparent;
    margin-bottom: -2px;
}

.tab-button:hover {
    color: var(--healthcare-primary);
}

.tab-button.active {
    color: var(--healthcare-primary);
    border-bottom-color: var(--healthcare-primary);
}

.analytics-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: var(--spacing-6);
    margin-bottom: var(--spacing-6);
}

.analytics-card {
    background: var(--glass-bg);
    backdrop-filter: var(--glass-blur);
    border: 1px solid var(--glass-border);
    border-radius: var(--radius-xl);
    padding: var(--spacing-6);
    box-shadow: var(--glass-shadow);
    transition: all var(--transition-normal);
}

.analytics-card:hover {
    box-shadow: var(--glass-shadow-lg);
    transform: translateY(-2px);
}

.chart-container {
    background: var(--glass-bg);
    backdrop-filter: var(--glass-blur);
    border: 1px solid var(--glass-border);
    border-radius: var(--radius-xl);
    padding: var(--spacing-6);
    margin-bottom: var(--spacing-6);
    min-height: 400px;
}

.chart-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: var(--spacing-4);
}

.chart-title {
    font-size: var(--font-size-xl);
    font-weight: var(--font-weight-semibold);
    color: var(--text-primary);
    margin: 0;
}

.chart-placeholder {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    border-radius: var(--radius-lg);
    min-height: 300px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: var(--font-size-lg);
    font-weight: var(--font-weight-medium);
    text-align: center;
    padding: var(--spacing-4);
}

.metric-value {
    font-size: var(--font-size-3xl);
    font-weight: var(--font-weight-bold);
    color: var(--healthcare-primary);
    margin: var(--spacing-2) 0;
}

.metric-label {
    font-size: var(--font-size-sm);
    color: var(--text-secondary);
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.metric-change {
    display: flex;
    align-items: center;
    gap: var(--spacing-1);
    font-size: var(--font-size-sm);
    font-weight: var(--font-weight-medium);
    margin-top: var(--spacing-2);
}

.metric-change.positive {
    color: var(--healthcare-success);
}

.metric-change.negative {
    color: var(--healthcare-danger);
}

.filter-section {
    background: var(--glass-bg);
    backdrop-filter: var(--glass-blur);
    border: 1px solid var(--glass-border);
    border-radius: var(--radius-xl);
    padding: var(--spacing-4);
    margin-bottom: var(--spacing-6);
    display: flex;
    align-items: center;
    gap: var(--spacing-4);
    flex-wrap: wrap;
}

.filter-group {
    display: flex;
    align-items: center;
    gap: var(--spacing-2);
}

.filter-label {
    font-size: var(--font-size-sm);
    color: var(--text-secondary);
    font-weight: var(--font-weight-medium);
}

.filter-select {
    padding: var(--spacing-2) var(--spacing-3);
    border: 1px solid var(--glass-border);
    border-radius: var(--radius-md);
    background: white;
    color: var(--text-primary);
    font-size: var(--font-size-sm);
}

.data-table {
    width: 100%;
    border-collapse: separate;
    border-spacing: 0;
}

.data-table thead {
    background: var(--glass-bg);
}

.data-table th {
    padding: var(--spacing-3);
    text-align: left;
    font-weight: var(--font-weight-semibold);
    color: var(--text-primary);
    border-bottom: 2px solid var(--glass-border);
}

.data-table td {
    padding: var(--spacing-3);
    border-bottom: 1px solid var(--glass-border);
}

.data-table tbody tr:hover {
    background: var(--glass-bg);
}

.export-button {
    background: var(--healthcare-primary);
    color: white;
    border: none;
    padding: var(--spacing-2) var(--spacing-4);
    border-radius: var(--radius-md);
    font-weight: var(--font-weight-medium);
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: var(--spacing-2);
    transition: background var(--transition-fast);
}

.export-button:hover {
    background: var(--healthcare-primary-dark);
}
</style>
{% endblock %}

{% block content %}
<div class="analytics-header">
    <div>
        <h1 class="analytics-title">
            <i class="fas fa-chart-line"></i>
            Analytics Dashboard
        </h1>
        <p class="dashboard-subtitle">Comprehensive hospital performance metrics and insights</p>
    </div>
    <div class="dashboard-actions">
        <select class="form-select" id="timeRange">
            <option value="24h">Last 24 Hours</option>
            <option value="7d" selected>Last 7 Days</option>
            <option value="30d">Last 30 Days</option>
            <option value="90d">Last 90 Days</option>
        </select>
        <button class="export-button">
            <i class="fas fa-download"></i>
            Export Report
        </button>
    </div>
</div>

<!-- Tab Navigation -->
<div class="tab-navigation">
    <button class="tab-button {% if not tab or tab == 'overview' %}active{% endif %}" data-tab="overview">
        <i class="fas fa-chart-pie me-2"></i>Overview
    </button>
    <button class="tab-button {% if tab == 'users' %}active{% endif %}" data-tab="users">
        <i class="fas fa-users me-2"></i>User Activity
    </button>
    <button class="tab-button {% if tab == 'performance' %}active{% endif %}" data-tab="performance">
        <i class="fas fa-tachometer-alt me-2"></i>System Performance
    </button>
    <button class="tab-button {% if tab == 'ai' %}active{% endif %}" data-tab="ai">
        <i class="fas fa-brain me-2"></i>AI Models
    </button>
    <button class="tab-button" data-tab="clinical">
        <i class="fas fa-heartbeat me-2"></i>Clinical Outcomes
    </button>
</div>

<!-- Key Metrics -->
<div class="analytics-grid">
    <div class="analytics-card">
        <div class="metric-label">Total Patients</div>
        <div class="metric-value">2,847</div>
        <div class="metric-change positive">
            <i class="fas fa-arrow-up"></i>
            <span>12% increase</span>
        </div>
    </div>
    
    <div class="analytics-card">
        <div class="metric-label">Appointments Today</div>
        <div class="metric-value">143</div>
        <div class="metric-change positive">
            <i class="fas fa-arrow-up"></i>
            <span>8% increase</span>
        </div>
    </div>
    
    <div class="analytics-card">
        <div class="metric-label">Bed Occupancy</div>
        <div class="metric-value">78%</div>
        <div class="metric-change positive">
            <i class="fas fa-arrow-up"></i>
            <span>5% increase</span>
        </div>
    </div>
    
    <div class="analytics-card">
        <div class="metric-label">AI Model Accuracy</div>
        <div class="metric-value">94.7%</div>
        <div class="metric-change positive">
            <i class="fas fa-arrow-up"></i>
            <span>2.1% improvement</span>
        </div>
    </div>
</div>

<!-- User Activity Chart -->
<div class="chart-container" id="userActivityChart" {% if tab and tab != 'users' %}style="display: none;"{% endif %}>
    <div class="chart-header">
        <h3 class="chart-title">
            <i class="fas fa-users me-2"></i>
            User Activity Trends
        </h3>
        <div class="filter-group">
            <label class="filter-label">Metric:</label>
            <select class="filter-select">
                <option>Active Users</option>
                <option>New Registrations</option>
                <option>Session Duration</option>
            </select>
        </div>
    </div>
    <div class="chart-placeholder">
        <div>
            <i class="fas fa-chart-area fa-3x mb-3"></i>
            <p>Interactive user activity chart will be displayed here<br>
            Showing login patterns, engagement metrics, and user growth trends</p>
        </div>
    </div>
</div>

<!-- System Performance Chart -->
<div class="chart-container" id="performanceChart" {% if tab and tab != 'performance' %}style="display: none;"{% endif %}>
    <div class="chart-header">
        <h3 class="chart-title">
            <i class="fas fa-tachometer-alt me-2"></i>
            System Performance Metrics
        </h3>
        <div class="filter-group">
            <label class="filter-label">View:</label>
            <select class="filter-select">
                <option>Response Time</option>
                <option>CPU Usage</option>
                <option>Memory Usage</option>
                <option>Database Performance</option>
            </select>
        </div>
    </div>
    <div class="chart-placeholder">
        <div>
            <i class="fas fa-server fa-3x mb-3"></i>
            <p>Real-time performance monitoring dashboard<br>
            Tracking response times, resource utilization, and system health</p>
        </div>
    </div>
</div>

<!-- AI Model Performance Chart -->
<div class="chart-container" id="aiPerformanceChart" {% if tab and tab != 'ai' %}style="display: none;"{% endif %}>
    <div class="chart-header">
        <h3 class="chart-title">
            <i class="fas fa-brain me-2"></i>
            AI Model Performance & Accuracy
        </h3>
        <div class="filter-group">
            <label class="filter-label">Model:</label>
            <select class="filter-select">
                <option>Risk Assessment</option>
                <option>Symptom Analysis</option>
                <option>Patient Flow Prediction</option>
                <option>Clinical Decision Support</option>
            </select>
        </div>
    </div>
    <div class="chart-placeholder">
        <div>
            <i class="fas fa-brain fa-3x mb-3"></i>
            <p>AI model accuracy and usage statistics<br>
            Monitoring prediction performance, model drift, and confidence scores</p>
        </div>
    </div>
</div>

<!-- Clinical Outcomes Chart -->
<div class="chart-container" id="clinicalChart" style="display: none;">
    <div class="chart-header">
        <h3 class="chart-title">
            <i class="fas fa-heartbeat me-2"></i>
            Clinical Outcomes & Quality Metrics
        </h3>
        <div class="filter-group">
            <label class="filter-label">Department:</label>
            <select class="filter-select">
                <option>All Departments</option>
                <option>Emergency</option>
                <option>Surgery</option>
                <option>ICU</option>
                <option>Cardiology</option>
            </select>
        </div>
    </div>
    <div class="chart-placeholder">
        <div>
            <i class="fas fa-heartbeat fa-3x mb-3"></i>
            <p>Patient outcome tracking and quality indicators<br>
            Monitoring readmission rates, treatment effectiveness, and patient satisfaction</p>
        </div>
    </div>
</div>

<!-- Recent Analytics Reports -->
<div class="chart-container">
    <div class="chart-header">
        <h3 class="chart-title">
            <i class="fas fa-file-alt me-2"></i>
            Recent Analytics Reports
        </h3>
    </div>
    <table class="data-table">
        <thead>
            <tr>
                <th>Report Name</th>
                <th>Generated</th>
                <th>Type</th>
                <th>Status</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td><i class="fas fa-file-pdf text-danger me-2"></i>Monthly Performance Report</td>
                <td>2 hours ago</td>
                <td><span class="badge bg-primary">Performance</span></td>
                <td><span class="badge bg-success">Complete</span></td>
                <td>
                    <button class="btn btn-sm btn-outline-primary">
                        <i class="fas fa-download"></i>
                    </button>
                </td>
            </tr>
            <tr>
                <td><i class="fas fa-file-excel text-success me-2"></i>Patient Flow Analysis</td>
                <td>5 hours ago</td>
                <td><span class="badge bg-info">Clinical</span></td>
                <td><span class="badge bg-success">Complete</span></td>
                <td>
                    <button class="btn btn-sm btn-outline-primary">
                        <i class="fas fa-download"></i>
                    </button>
                </td>
            </tr>
            <tr>
                <td><i class="fas fa-file-pdf text-danger me-2"></i>AI Model Performance Review</td>
                <td>1 day ago</td>
                <td><span class="badge bg-warning">AI/ML</span></td>
                <td><span class="badge bg-success">Complete</span></td>
                <td>
                    <button class="btn btn-sm btn-outline-primary">
                        <i class="fas fa-download"></i>
                    </button>
                </td>
            </tr>
        </tbody>
    </table>
</div>

<script>
// Tab switching functionality
document.querySelectorAll('.tab-button').forEach(button => {
    button.addEventListener('click', function() {
        // Remove active class from all buttons
        document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
        
        // Add active class to clicked button
        this.classList.add('active');
        
        // Hide all charts
        document.querySelectorAll('.chart-container[id$="Chart"]').forEach(chart => {
            chart.style.display = 'none';
        });
        
        // Show selected chart
        const tab = this.getAttribute('data-tab');
        if (tab === 'users') {
            document.getElementById('userActivityChart').style.display = 'block';
        } else if (tab === 'performance') {
            document.getElementById('performanceChart').style.display = 'block';
        } else if (tab === 'ai') {
            document.getElementById('aiPerformanceChart').style.display = 'block';
        } else if (tab === 'clinical') {
            document.getElementById('clinicalChart').style.display = 'block';
        }
    });
});
</script>
{% endblock %}
